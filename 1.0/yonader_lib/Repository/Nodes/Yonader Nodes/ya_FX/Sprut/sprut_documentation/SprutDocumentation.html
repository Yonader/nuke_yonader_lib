<html><head><title>Sprut Documentation</title><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">.lst-kix_9ge0qy394jq5-6>li:before{content:"\0025cf  "}.lst-kix_1pjn3wjgo308-4>li:before{content:"\0025cb  "}.lst-kix_9ge0qy394jq5-5>li:before{content:"\0025a0  "}.lst-kix_x8v008eqbtnd-2>li:before{content:"\0025a0  "}.lst-kix_9ge0qy394jq5-2>li:before{content:"\0025a0  "}.lst-kix_1pjn3wjgo308-2>li:before{content:"\0025a0  "}.lst-kix_x8v008eqbtnd-6>li:before{content:"\0025cf  "}.lst-kix_9ge0qy394jq5-4>li:before{content:"\0025cb  "}.lst-kix_9ge0qy394jq5-1>li:before{content:"\0025cb  "}.lst-kix_1pjn3wjgo308-8>li:before{content:"\0025a0  "}ul.lst-kix_9ge0qy394jq5-6{list-style-type:none}ul.lst-kix_9ge0qy394jq5-7{list-style-type:none}ul.lst-kix_9ge0qy394jq5-4{list-style-type:none}ul.lst-kix_9ge0qy394jq5-5{list-style-type:none}ul.lst-kix_9ge0qy394jq5-2{list-style-type:none}ul.lst-kix_9ge0qy394jq5-3{list-style-type:none}ul.lst-kix_9ge0qy394jq5-0{list-style-type:none}ul.lst-kix_9ge0qy394jq5-1{list-style-type:none}.lst-kix_1pjn3wjgo308-3>li:before{content:"\0025cf  "}.lst-kix_1pjn3wjgo308-7>li:before{content:"\0025cb  "}ul.lst-kix_9ge0qy394jq5-8{list-style-type:none}.lst-kix_x8v008eqbtnd-0>li:before{content:"\0025cf  "}.lst-kix_1pjn3wjgo308-1>li:before{content:"\0025cb  "}.lst-kix_x8v008eqbtnd-8>li:before{content:"\0025a0  "}.lst-kix_9ge0qy394jq5-3>li:before{content:"\0025cf  "}.lst-kix_9ge0qy394jq5-8>li:before{content:"\0025a0  "}ul.lst-kix_1pjn3wjgo308-3{list-style-type:none}ul.lst-kix_1pjn3wjgo308-4{list-style-type:none}.lst-kix_x8v008eqbtnd-7>li:before{content:"\0025cb  "}ul.lst-kix_1pjn3wjgo308-1{list-style-type:none}ul.lst-kix_1pjn3wjgo308-2{list-style-type:none}.lst-kix_x8v008eqbtnd-5>li:before{content:"\0025a0  "}ul.lst-kix_1pjn3wjgo308-7{list-style-type:none}ul.lst-kix_x8v008eqbtnd-1{list-style-type:none}.lst-kix_x8v008eqbtnd-3>li:before{content:"\0025cf  "}ul.lst-kix_1pjn3wjgo308-8{list-style-type:none}ul.lst-kix_x8v008eqbtnd-2{list-style-type:none}ul.lst-kix_1pjn3wjgo308-5{list-style-type:none}ul.lst-kix_1pjn3wjgo308-6{list-style-type:none}ul.lst-kix_x8v008eqbtnd-0{list-style-type:none}ul.lst-kix_x8v008eqbtnd-5{list-style-type:none}ul.lst-kix_x8v008eqbtnd-6{list-style-type:none}.lst-kix_1pjn3wjgo308-0>li:before{content:"\0025cf  "}ul.lst-kix_x8v008eqbtnd-3{list-style-type:none}.lst-kix_1pjn3wjgo308-6>li:before{content:"\0025cf  "}ul.lst-kix_x8v008eqbtnd-4{list-style-type:none}ul.lst-kix_x8v008eqbtnd-7{list-style-type:none}ul.lst-kix_x8v008eqbtnd-8{list-style-type:none}.lst-kix_x8v008eqbtnd-4>li:before{content:"\0025cb  "}.lst-kix_9ge0qy394jq5-7>li:before{content:"\0025cb  "}.lst-kix_1pjn3wjgo308-5>li:before{content:"\0025a0  "}ul.lst-kix_1pjn3wjgo308-0{list-style-type:none}.lst-kix_x8v008eqbtnd-1>li:before{content:"\0025cb  "}.lst-kix_9ge0qy394jq5-0>li:before{content:"\0025cf  "}ol{margin:0;padding:0}.c7{max-width:468pt;background-color:#ffffff;padding:72pt 72pt 72pt 72pt}.c12{color:inherit;text-decoration:inherit}.c4{font-size:14pt;font-weight:bold}.c14{color:#444444;background-color:#ffffff}.c2{padding-left:0pt;margin-left:36pt}.c6{margin:0;padding:0}.c0{font-size:10pt}.c3{height:11pt}.c10{font-weight:bold}.c13{color:#1155cc}.c1{direction:ltr}.c5{font-size:12pt}.c9{text-decoration:underline}.c11{font-style:italic}.c8{font-size:14pt}.title{widows:2;padding-top:0pt;line-height:1.15;orphans:2;text-align:left;color:#000000;font-size:21pt;font-family:"Trebuchet MS";padding-bottom:0pt;page-break-after:avoid}.subtitle{widows:2;padding-top:0pt;line-height:1.15;orphans:2;text-align:left;color:#666666;font-style:italic;font-size:13pt;font-family:"Trebuchet MS";padding-bottom:10pt;page-break-after:avoid}li{color:#000000;font-size:11pt;font-family:"Arial"}p{color:#000000;font-size:11pt;margin:0;font-family:"Arial"}h1{widows:2;padding-top:10pt;line-height:1.15;orphans:2;text-align:left;color:#000000;font-size:16pt;font-family:"Trebuchet MS";padding-bottom:0pt;page-break-after:avoid}h2{widows:2;padding-top:10pt;line-height:1.15;orphans:2;text-align:left;color:#000000;font-size:13pt;font-family:"Trebuchet MS";font-weight:bold;padding-bottom:0pt;page-break-after:avoid}h3{widows:2;padding-top:8pt;line-height:1.15;orphans:2;text-align:left;color:#666666;font-size:12pt;font-family:"Trebuchet MS";font-weight:bold;padding-bottom:0pt;page-break-after:avoid}h4{widows:2;padding-top:8pt;line-height:1.15;orphans:2;text-align:left;color:#666666;font-size:11pt;text-decoration:underline;font-family:"Trebuchet MS";padding-bottom:0pt;page-break-after:avoid}h5{widows:2;padding-top:8pt;line-height:1.15;orphans:2;text-align:left;color:#666666;font-size:11pt;font-family:"Trebuchet MS";padding-bottom:0pt;page-break-after:avoid}h6{widows:2;padding-top:8pt;line-height:1.15;orphans:2;text-align:left;color:#666666;font-style:italic;font-size:11pt;font-family:"Trebuchet MS";padding-bottom:0pt;page-break-after:avoid}</style></head><body class="c7"><p class="c1"><img height="292" src="images/image02.jpg" width="624"></p><p class="c1"><span class="c0">Sprut (c) 2012-2014 Theodor Groeneboom - </span><span class="c0 c9 c13"><a class="c12" href="http://www.euqahuba.com">www.euqahuba.com</a></span><span class="c0">&nbsp;</span><span class="c0">(theo@euqahuba.com)</span></p><p class="c3 c1"><span class="c5"></span></p><p class="c1"><span class="c4 c9">About Sprut 1.0</span></p><p class="c3 c1"><span class="c8"></span></p><p class="c1"><span class="c5">&ldquo;</span><span class="c10 c5">sprut</span><span class="c5">&rdquo; [sprut] (norwegian); </span><span class="c5 c11">splash, squirt, jet</span></p><p class="c1"><span>Sprut is a simple set of free tools for 2d fluid simulation work within The Foundry&rsquo;s Nuke. Based on and around Jos Stam&rsquo;s 1999 Siggraph paper &ldquo;Stable Fluids&rdquo;, it was created using standard Nuke 2D nodes only, a fact that makes it the first truly open, flexible and portable fluid toolkit within Nuke. At this point, the tool set comprises of three nodes: SprutEmitter, SprutSolver and SprutInspect - all described and explained further down below.</span></p><p class="c3 c1"><span></span></p><p class="c1"><img height="229" src="images/image01.jpg" width="624"><span class="c0">Figure 1:</span><span class="c5">&nbsp;</span><span class="c0">A simple Sprut setup in Nuke 8.</span></p><p class="c3 c1"><span class="c0"></span></p><p class="c1"><span class="c4 c9">Acknowledgment</span></p><p class="c1"><span class="c0">Thanks to Andre Hits&oslash;y, Lucie</span><span class="c0 c14">n Fostier &amp; Michael Ralla for contributions.</span></p><p class="c3 c1"><span class="c8"></span></p><p class="c3 c1"><span class="c4 c9"></span></p><p class="c1"><span class="c4 c9">About SprutEmitter</span></p><p class="c3 c1"><span></span></p><p class="c1"><span>As the name suggests, t</span><span>he SprutEmitter is the source node for a fluid. </span></p><p class="c3 c1"><span></span></p><p class="c1"><span>The way it is set up, it gives you initial control over fluid emission, as the sourcing and creation of fluids is often more important than the actual solve itself. It contains a set of functions to create densities (RGBA) and velocities (motion) in the value ranges SprutSolver expects. It has option for animating the source position with a standard transform; this, in turn, creates the appropriate motion vectors for the movement of the fluid. </span></p><p class="c3 c1"><span></span></p><p class="c1"><span>There are also options for adding various other velocities fields; like constant direction, random direction and turbulence.</span></p><p class="c3 c1"><span></span></p><p class="c1"><span class="c10">Emitter settings &nbsp;:</span><span>&nbsp;</span></p><p class="c3 c1"><span></span></p><p class="c1"><img height="179" src="images/image07.gif" width="179"><img height="179" src="images/image12.gif" width="179"><img height="179" src="images/image03.gif" width="179"></p><p class="c1"><span class="c0">Figure 2: Emitter velocities - (1) Inherit motion from translation. (2) Turbulence velocities only. (3) Random directional force. </span></p><p class="c3 c1"><span></span></p><p class="c1"><img height="179" src="images/image08.gif" width="179"></p><p class="c1"><span class="c0">Figure 3: Emitter velocities - Constant direction will add a single direction to the emission of the fluid.</span></p><p class="c3 c1"><span></span></p><p class="c3 c1"><span></span></p><p class="c3 c1"><span class="c5"></span></p><p class="c3 c1"><span class="c5"></span></p><p class="c3 c1"><span class="c4 c9"></span></p><p class="c3 c1"><span class="c4 c9"></span></p><p class="c1"><span class="c4 c9">About SprutSolver</span></p><p class="c1 c3"><span></span></p><p class="c1"><span>SprutSolver</span><span>&nbsp;is the heart of the entire fluid simulation operation, &nbsp;it is where the projection and movement of the fluid is computed through a set of nodes.</span></p><p class="c3 c1"><span></span></p><p class="c1"><span>However, most of the time will be spent on working with the emission and adjusting parameters in SprutEmitter, instead of the solver, as the solver only allows for adjustments to the overall simulation. </span></p><p class="c3 c1"><span></span></p><p class="c1"><span class="c10 c11">Note:</span></p><p class="c1"><span>As the basic principle of stable fluids is based on creating and maintaining a feedback-loop within the system, Sprut writes out a sequence of images that are, in return, read in and overwritten over and over again. Hence, it is necessary</span><span>&nbsp;to specify a target folder for the fluid to be cached in and also set the frame ranges manually. For this reason, full read and write permissions to that folder are required - also, using any facility managed write nodes instead of Nuke&rsquo;s standard usually creates problems. </span></p><p class="c3 c1"><span></span></p><p class="c1"><span>SprutSolver also offers additional control to adjust the dissipation, diffusion of both densities and velocities during the simulation, as well as it provides post-simulation controls for adding motion-blur.</span></p><p class="c3 c1"><span></span></p><p class="c3 c1"><span></span></p><p class="c1"><span class="c10">Solver setting examples:</span></p><p class="c3 c1"><span></span></p><p class="c1"><img height="179" src="images/image10.gif" width="179"><img height="179" src="images/image04.gif" width="179"><img height="179" src="images/image13.gif" width="179"></p><p class="c1"><span class="c0">Viscoscity - Adds a dragging and thickness to the motion of the fluid. At 0px, 5px and 16px.</span></p><p class="c3 c1"><span></span></p><p class="c1"><img height="179" src="images/image09.gif" width="179"><img height="179" src="images/image00.gif" width="179"></p><p class="c1"><span class="c0">Figure 4: Dissipation - Causes the fluid density or motion to rapidly decrease on each frame.</span></p><p class="c1"><span>&nbsp;</span></p><p class="c1"><img height="179" src="images/image05.gif" width="179"></p><p class="c1"><span class="c0">Figure 5: Diffusion - Causes the densities or motion vectors to be diffused / blurred on each time step.</span><span>&nbsp;</span></p><p class="c3 c1"><span></span></p><p class="c1"><img height="179" src="images/image11.gif" width="179"></p><p class="c1"><span class="c0">Figure 6: Directional Force - Adds a constant directional force to the overall simulation.</span></p><p class="c3 c1"><span></span></p><p class="c3 c1"><span></span></p><p class="c3 c1"><span class="c4 c9"></span></p><hr style="page-break-before:always;display:none;"><p class="c3 c1"><span class="c4 c9"></span></p><p class="c1"><span class="c4 c9">About SprutInspect</span></p><p class="c3 c1"><span></span></p><p class="c1"><span>SprutInspect is a diagnostics tool to visually analyze and evaluate direction and amplitude of motion vectors.</span></p><p class="c3 c1"><span></span></p><p class="c1"><span>Connected downstream from a SprutSolver node, it displays a grid pattern that is directly related to the fluid simulation and can be used to clearly identify problems and issues and debug existing solves.</span></p><p class="c3 c1"><span></span></p><p class="c1"><img height="134" src="images/image06.gif" width="179"></p><p class="c1"><span class="c0">Figure 7: SprutInspect diagnostic image</span></p><p class="c3 c1"><span></span></p><p class="c3 c1"><span class="c8"></span></p><hr style="page-break-before:always;display:none;"><p class="c3 c1"><span class="c8"></span></p><p class="c1"><span class="c4 c9">Tips&amp;Tricks</span></p><p class="c3 c1"><span class="c4"></span></p><ul class="c6 lst-kix_9ge0qy394jq5-0 start"><li class="c2 c1"><span>Make sure you have write permissions for the cache folder, and are not using any kind of facility managed write nodes.</span></li></ul><p class="c3 c1"><span></span></p><ul class="c6 lst-kix_9ge0qy394jq5-0"><li class="c1 c2"><span>Setting up a good emitter is key for the fluids to look good. Spend more time on the emission then on adjusting the solver. &nbsp;</span></li></ul><p class="c3 c1"><span></span></p><ul class="c6 lst-kix_9ge0qy394jq5-0"><li class="c2 c1"><span>You can combine multiple emitters by merging two emitters and making sure you also merge RGBA and MOTION.</span></li></ul><p class="c3 c1"><span></span></p><ul class="c6 lst-kix_9ge0qy394jq5-0"><li class="c2 c1"><span>You can create your own emitter tools using the ScanlineRender and its motion vector outputs. (see Figure 3)</span></li></ul><p class="c3 c1"><span></span></p><ul class="c6 lst-kix_9ge0qy394jq5-0"><li class="c2 c1"><span>The cached motion vectors can also be used for adding motion blur or distorting a background image.</span></li></ul><p class="c3 c1"><span></span></p><ul class="c6 lst-kix_9ge0qy394jq5-0"><li class="c2 c1"><span>Use SprutInspect to examine motion vectors. </span></li></ul><p class="c3 c1"><span></span></p><ul class="c6 lst-kix_9ge0qy394jq5-0"><li class="c2 c1"><span>Nuke&rsquo;s Oflow tools can extract motion vectors for the solver to use. </span></li></ul><p class="c3 c1"><span></span></p><ul class="c6 lst-kix_9ge0qy394jq5-0"><li class="c2 c1"><span>You can open the SprutSolver gizmo and add additional nodes for fluid termination using masks.</span></li></ul><p class="c3 c1"><span></span></p><ul class="c6 lst-kix_9ge0qy394jq5-0"><li class="c2 c1"><span>It is not uncommon for the velocity values to go really high. (-300-+300)</span></li></ul><p class="c3 c1"><span></span></p><ul class="c6 lst-kix_9ge0qy394jq5-0"><li class="c2 c1"><span>Cache to a local SSD for faster simulations.</span></li></ul><p class="c3 c1"><span></span></p><p class="c3 c1"><span class="c8"></span></p><p class="c1"><span class="c4 c9">License</span></p><p class="c3 c1"><span></span></p><p class="c1"><span>Sprut is distributed under GNU/GPL. It may be used for commercial purposes, but not redistributed or repackaged, in particular not for any fee. </span></p><p class="c3 c1"><span></span></p></body></html>