#! C:/Program Files/Nuke10.5v6/nuke-10.5.6.dll -nx
version 10.5 v6
Gizmo {
 inputs 3
 name AL_Defocus
 knobChanged "\nn = nuke.thisNode()\nk = nuke.thisKnob()\n\nif k.name() == 'OutputType':\n  n\['bokehVizPos'].setVisible(k.value() == \"Bokeh\")\n  n\['bokehVizSize'].setVisible(k.value() == \"Bokeh\")\n  n\['killSize'].setVisible(k.value() == \"Bokeh\")\n\nlens_list = \['relativeFilterSize', 'maskRadius', 'softness', 'noiseSize', 'noiseContrast']\ndiaphragm_list = \['radius', 'size_mult', 'anamorph', 'ring_color', 'ring_color_panelDropped', 'inner_color', 'inner_color_panelDropped', 'outer_falloff', 'outer_falloff_panelDropped', 'inner_falloff', 'inner_falloff_panelDropped', 'chroma_spread', 'chroma_shift', 'chroma_shift_angle', 'corners', 'flattening', 'sharpness', 'corners_angle']\n\nviz_list = \[\"vizLens\", \"vizDiaphragm\", \"vizRot\", \"vizSkew\", \"vizChroAbr\", \"vizLensOffset\", \"vizSize\"]\n\nif k.name() in viz_list:\n  disable_list = list(viz_list)\[:]\n  disable_list.remove(k.name())\n  for viz_knob in disable_list:\n    n\[viz_knob].setValue(False)\n\nif k.name() == 'inputChange':\n  for input_node in nuke.allNodes('Input', group=nuke.thisGroup()):\n    disable_list = list()\n    if input_node.name() == 'InputLens':\n      disable_list = lens_list\n    elif input_node.name() == 'InputFilter':\n      disable_list = diaphragm_list\n    for each in disable_list:\n      n\[each].setEnabled(input_node.channels()==\[])\n\n"
 tile_color 0xcc804eff
 addUserKnob {20 Bokeh}
 addUserKnob {4 OutputType l "Output Type" t "Show the result or only the filter's preview at a specific coordinate" M {Result Bokeh}}
 addUserKnob {12 bokehVizPos l Position t "Coordinate of the filter's preview" +HIDDEN}
 bokehVizPos {1500 300}
 addUserKnob {7 bokehVizSize l Size t "Scale the filter for the preview" +HIDDEN R 0 10}
 bokehVizSize 1
 addUserKnob {6 killSize l "Disable Size input" t "Don't preview the size map on the filter" +HIDDEN +STARTLINE}
 killSize true
 addUserKnob {26 div l "" +STARTLINE}
 addUserKnob {12 OpticalCenter l "Optical center" t "Define the optical center, this is use by the default maps, typicaly height/2 width/2"}
 OpticalCenter {{width/2} {height/2}}
 addUserKnob {26 Size l "@b;Size" t "Scale the filter based on the values of the map (Red chanel)"}
 addUserKnob {6 vizSize l "◄ Viz" t "Visualize only the Size map" +STARTLINE}
 addUserKnob {41 in_4 l map t "Choose which map control the size" T ShuffleSize.in}
 addUserKnob {7 SizeMult l "size mult" t "Default Size"}
 SizeMult 0.5
 addUserKnob {26 diaphragmRotation l "@b;Diaphragm rotation" t "Rotate the filter based on the values of the map (Red chanel)"}
 addUserKnob {6 vizRot l "◄ Viz" t "Visualize only the Rotation map" +STARTLINE}
 addUserKnob {41 in_3 l map t "Choose which map control the rotation" T ShuffleRot.in}
 addUserKnob {7 Rotation t "Default Rotation" R 0 360}
 addUserKnob {6 orientOpticalCenter l "Orient to optical center" t "Orient the filter toward the optical center" +STARTLINE}
 addUserKnob {26 diaphSkew l "@b;Diaphragm skew" t "Skew the filter based on the values of the map (Red chanel for orientation, Green for scale)"}
 addUserKnob {6 vizSkew l "◄ Viz" t "Visualize only the Skew map" +STARTLINE}
 addUserKnob {41 in_2 l map t "Choose which map control the skew" T ShuffleSkew.in}
 addUserKnob {4 TypeSkew l "Type " t "Choose the type of default map\n- <b>Radial:</b> Skew toward the optical center\n- <b>Anamorphic:</b> Skew only on the X axis" M {Radial Anamorphic "" "" ""}}
 addUserKnob {7 min l "min skew" t "Min scale of the shew"}
 min 0.6
 addUserKnob {7 max l "max skew" t "Max scale of the skew"}
 max 1
 addUserKnob {26 chroma l "@b;Chromatic Aberation" t "Shift the channels of the filter based on the values of the map (Red chanel for x direction, Green for y direction)"}
 addUserKnob {6 vizChroAbr l "◄ Viz" t "Visualize only the Chroma map" +STARTLINE}
 addUserKnob {41 in l map t "Choose which map control the Chroma map" T ShuffleChroma.in}
 addUserKnob {7 ChromaticAberationMult l "Overall abr mult" t "Multiply the amount of shift effect on the default map" R -10 10}
 ChromaticAberationMult 10
 addUserKnob {12 chromaR l "<font color=#a42840><b>Red</font>" t "Multiply the amount of shift for the red channel on the x and y axis" +NO_HANDLES}
 chromaR {3 3}
 addUserKnob {12 chromaG l "<font color=#45b898><b>Green</font>" t "Multiply the amount of shift for the green channel on the x and y axis" +NO_HANDLES}
 chromaG {1 1}
 addUserKnob {12 chromaB l "<font color=#258dbf><b>Blue</font>" t "Multiply the amount of shift for the blue channel on the x and y axis" +NO_HANDLES}
 addUserKnob {26 lensOffset l "@b;Lens offset" t "Offset the lens based on the values of the map (Red chanel for x direction, Green for y direction)\nThe filter is multiply by the lens at convolution time"}
 addUserKnob {6 vizLensOffset l "◄ Viz" t "Visualize only the Offset map" +STARTLINE}
 addUserKnob {41 in_1 l map t "Choose which map control the Offset map" T ShuffleOffset.in}
 addUserKnob {7 LensOffsetMultipiler l "Lens offset mult" t "Multiply the amount of offset effect on the default map" R -100 100}
 LensOffsetMultipiler -100
 addUserKnob {20 Filter}
 addUserKnob {41 box_width_1 l "Filter Size" t "Base filter size in x" T filterSize.box_width}
 addUserKnob {41 box_height_1 l "" t "Base filter size in y" -STARTLINE T filterSize.box_height}
 addUserKnob {41 box_fixed l "force this shape" -STARTLINE T filterSize.box_fixed}
 addUserKnob {20 Diaphragm n 1}
 addUserKnob {6 vizDiaphragm l "◄ Viz" t "Visualize only the Diaphragm filter" -STARTLINE}
 addUserKnob {26 "" l "@b;Size"}
 addUserKnob {41 radius T Flare1.radius}
 addUserKnob {41 size_mult l "size mult" T Flare1.size_mult}
 addUserKnob {41 anamorph T Flare1.anamorph}
 addUserKnob {26 "" l "@b;Colors"}
 addUserKnob {41 ring_color l "ring color" T Flare1.ring_color}
 addUserKnob {41 ring_color_panelDropped l "panel dropped state" T Flare1.ring_color_panelDropped}
 addUserKnob {41 inner_color l "inner color" T Flare1.inner_color}
 addUserKnob {41 inner_color_panelDropped l "panel dropped state" T Flare1.inner_color_panelDropped}
 addUserKnob {41 outer_falloff l "outer falloff" T Flare1.outer_falloff}
 addUserKnob {41 outer_falloff_panelDropped l "panel dropped state" T Flare1.outer_falloff_panelDropped}
 addUserKnob {41 inner_falloff l "inner falloff" T Flare1.inner_falloff}
 addUserKnob {41 inner_falloff_panelDropped l "panel dropped state" T Flare1.inner_falloff_panelDropped}
 addUserKnob {26 "" l "@b;Color Shifts"}
 addUserKnob {41 chroma_spread l "chroma spread" T Flare1.chroma_spread}
 addUserKnob {41 chroma_shift l "chroma shift" T Flare1.chroma_shift}
 addUserKnob {41 chroma_shift_angle l angle T Flare1.chroma_shift_angle}
 addUserKnob {26 "" l "@b;Shape"}
 addUserKnob {41 corners T Flare1.corners}
 addUserKnob {41 flattening l "edge flattening" T Flare1.flattening}
 addUserKnob {41 sharpness l "corner sharpness" T Flare1.sharpness}
 addUserKnob {41 corners_angle l angle T Flare1.corners_angle}
 addUserKnob {20 endGroup n -1}
 addUserKnob {20 lensGroup l lens +DISABLED n 1}
 addUserKnob {6 vizLens l "◄ Viz" t "Visualize only the Lens filter" +STARTLINE}
 addUserKnob {7 relativeFilterSize l "Size Relative To Filter" t "Multiply the size of the diaphragm to set the lens size" R 0 10}
 relativeFilterSize 1.5
 addUserKnob {26 Mask l "@b;Mask"}
 addUserKnob {7 maskRadius l "Mask radius" t "Size of the radial in the lens" R 0 10}
 maskRadius 1
 addUserKnob {7 softness l "Mask softness" t "Softness of the radial in the lens"}
 softness 0.02
 addUserKnob {26 radialNoise l "@b;Radial noise"}
 addUserKnob {7 noiseSize l "Noise Size" t "Size of the circular noise in the lens" R 0 100}
 noiseSize 3
 addUserKnob {7 noiseContrast l "Noise contrast" t "Contraste of the circular noise in the lens" R 0 2}
 noiseContrast 0.6
 addUserKnob {20 endGroup_1 l endGroup n -1}
 addUserKnob {20 "" l "Kernel Parameters"}
 addUserKnob {41 "Local GPU: " T Defocus.AL_Defocus.gpuName}
 addUserKnob {41 useGPUIfAvailable l "Use GPU if available" T Defocus.AL_Defocus.useGPUIfAvailable}
 addUserKnob {41 vectorize l "Vectorize on CPU" -STARTLINE T Defocus.AL_Defocus.vectorize}
 addUserKnob {26 ""}
 addUserKnob {41 maxGPUMemory l "Percentage of GPU memory to use" T Defocus.AL_Defocus.maxGPUMemory}
 addUserKnob {41 maxTileLines l "Percentage of image height per tile" T Defocus.AL_Defocus.maxTileLines}
 addUserKnob {20 about l About}
 addUserKnob {26 about_author l "" +STARTLINE T "AL_Defocus Gizmo <i>v1.0</i><p><b>Arthur Loiseau © 2017</b>"}
 addUserKnob {26 ""}
 addUserKnob {26 website l "" +STARTLINE T "<a href=\"http://arthurloiseau.com\"><span style=\"color:#C8C8C8;\">www.arthurloiseau.com</span></a>"}
 addUserKnob {52 callback T "nuke.thisNode().knob('knobChanged').setValue(\"\"\"\nn = nuke.thisNode()\nk = nuke.thisKnob()\n\nif k.name() == 'OutputType':\n  n\['bokehVizPos'].setVisible(k.value() == \"Bokeh\")\n  n\['bokehVizSize'].setVisible(k.value() == \"Bokeh\")\n  n\['killSize'].setVisible(k.value() == \"Bokeh\")\n\nlens_list = \['relativeFilterSize', 'maskRadius', 'softness', 'noiseSize', 'noiseContrast']\ndiaphragm_list = \['radius', 'size_mult', 'anamorph', 'ring_color', 'ring_color_panelDropped', 'inner_color', 'inner_color_panelDropped', 'outer_falloff', 'outer_falloff_panelDropped', 'inner_falloff', 'inner_falloff_panelDropped', 'chroma_spread', 'chroma_shift', 'chroma_shift_angle', 'corners', 'flattening', 'sharpness', 'corners_angle']\n\nviz_list = \[\"vizLens\", \"vizDiaphragm\", \"vizRot\", \"vizSkew\", \"vizChroAbr\", \"vizLensOffset\", \"vizSize\"]\n\nif k.name() in viz_list:\n  disable_list = list(viz_list)\[:]\n  disable_list.remove(k.name())\n  for viz_knob in disable_list:\n    n\[viz_knob].setValue(False)\n\nif k.name() == 'inputChange':\n  for input_node in nuke.allNodes('Input', group=nuke.thisGroup()):\n    disable_list = list()\n    if input_node.name() == 'InputLens':\n      disable_list = lens_list\n    elif input_node.name() == 'InputFilter':\n      disable_list = diaphragm_list\n    for each in disable_list:\n      n\[each].setEnabled(input_node.channels()==\[])\n\n\"\"\")\n\n\n\n" +STARTLINE}
}
 BackdropNode {
  inputs 0
  name BackdropNode1
  tile_color 0x365e8eff
  label "VIZ BOKEH"
  note_font_size 42
  xpos 646
  ypos 1124
  bdwidth 247
  bdheight 268
 }
 BackdropNode {
  inputs 0
  name BackdropNode2
  tile_color 0x47476bff
  label VIZ
  note_font_size 42
  xpos -773
  ypos 1281
  bdwidth 1355
  bdheight 373
 }
 BackdropNode {
  inputs 0
  name BackdropNode3
  tile_color 0x396836ff
  label DEFOCUS
  note_font_size 42
  xpos -771
  ypos 1103
  bdwidth 1350
  bdheight 161
 }
 BackdropNode {
  inputs 0
  name BackdropNode4
  tile_color 0x8e3838ff
  label "SWITCH MAPS"
  note_font_size 42
  xpos -770
  ypos 472
  bdwidth 1348
  bdheight 214
 }
 BackdropNode {
  inputs 0
  name BackdropNode5
  tile_color 0x9b823dff
  label MAPS
  note_font_size 42
  xpos -761
  ypos 137
  bdwidth 1339
  bdheight 312
 }
 BackdropNode {
  inputs 0
  name BackdropNode6
  tile_color 0x515454ff
  label "FILTER AND LENS"
  note_font_size 42
  xpos -759
  ypos -363
  bdwidth 1334
  bdheight 477
 }
 NoOp {
  inputs 0
  name Parameter
  xpos -315
  ypos 159
  hide_input true
  addUserKnob {20 User}
  addUserKnob {12 lensCenter}
  lensCenter {{parent.OpticalCenter.x} {parent.OpticalCenter.y}}
 }
 Input {
  inputs 0
  name src
  xpos 494
  ypos -447
 }
 Dot {
  name Dot8
  xpos 528
  ypos -329
 }
set Nf35fc00 [stack 0]
 Dot {
  name Dot10
  xpos 355
  ypos -329
 }
set Nf35f800 [stack 0]
 Dot {
  name Dot14
  xpos -147
  ypos -329
 }
set Nf35f400 [stack 0]
 Dot {
  name Dot13
  xpos -366
  ypos -329
 }
set Nf35f000 [stack 0]
 Dot {
  name Dot21
  xpos -545
  ypos -329
 }
set Nf35ec00 [stack 0]
 Dot {
  name Dot9
  xpos -726
  ypos -329
 }
 Shuffle {
  in none
  name ShuffleChroma
  knobChanged "\nchanged_knob = nuke.thisKnob()\n\nchroma_list_knob = \['ChromaticAberationMult']\n\nif changed_knob.name() == 'in':\n  group = nuke.thisGroup()\n  for knob in chroma_list_knob:\n    group\[knob].setEnabled(changed_knob.value() == 'none')\n\n"
  xpos -760
  ypos 540
  addUserKnob {20 User}
  addUserKnob {52 callback T "nuke.thisNode().knob('knobChanged').setValue(\"\"\"\nchanged_knob = nuke.thisKnob()\n\nchroma_list_knob = \['ChromaticAberationMult']\n\nif changed_knob.name() == 'in':\n  group = nuke.thisGroup()\n  for knob in chroma_list_knob:\n    group\[knob].setEnabled(changed_knob.value() == 'none')\n\n\"\"\")\n\n" +STARTLINE}
 }
push $Nf35fc00
 Dot {
  name Dot1
  xpos 528
  ypos 216
 }
set Nf35e000 [stack 0]
 Shuffle {
  red black
  green black
  blue black
  alpha black
  name toBlack
  xpos 382
  ypos 212
 }
 Dot {
  name Dot23
  xpos -76
  ypos 216
 }
set Nf379800 [stack 0]
 Dot {
  name Dot24
  xpos -218
  ypos 216
 }
set Nf379400 [stack 0]
 Dot {
  name Dot22
  xpos -313
  ypos 216
 }
set Nf379000 [stack 0]
 Expression {
  temp_name0 xCenter
  temp_expr0 parent.Parameter.lensCenter.x/width
  temp_name1 yCenter
  temp_expr1 parent.Parameter.lensCenter.y/height
  expr0 xCenter-(x/width)
  expr1 yCenter-(y/height)
  expr2 xCenter-(x/width)
  expr3 yCenter-(y/height)
  name Expression2
  xpos -494
  ypos 212
 }
set Nf378c00 [stack 0]
 Dot {
  name Dot25
  xpos -638
  ypos 289
 }
 Multiply {
  value {{parent.ChromaticAberationMult}}
  name MultiplyChroma
  xpos -672
  ypos 396
 }
 Switch {
  inputs 2
  which {{ShuffleChroma.in}}
  name SwitchChroma
  xpos -672
  ypos 645
 }
set N3ca7b00 [stack 0]
 Dot {
  name Dot26
  xpos -638
  ypos 1065
 }
set Nf3a7c00 [stack 0]
 Dot {
  name Dot19
  xpos -638
  ypos 1625
 }
push $Nf35ec00
 Shuffle {
  in none
  name ShuffleOffset
  knobChanged "\nchanged_knob = nuke.thisKnob()\n\noffset_list_knob = \['LensOffsetMultipiler']\n\nif changed_knob.name() == 'in':\n  group = nuke.thisGroup()\n  for knob in offset_list_knob:\n    group\[knob].setEnabled(changed_knob.value() == 'none')\n\n"
  xpos -579
  ypos 540
  addUserKnob {20 User}
  addUserKnob {52 callback T "nuke.thisNode().knob('knobChanged').setValue(\"\"\"\nchanged_knob = nuke.thisKnob()\n\noffset_list_knob = \['LensOffsetMultipiler']\n\nif changed_knob.name() == 'in':\n  group = nuke.thisGroup()\n  for knob in offset_list_knob:\n    group\[knob].setEnabled(changed_knob.value() == 'none')\n\n\"\"\")" +STARTLINE}
 }
push $Nf378c00
 Multiply {
  value {{parent.LensOffsetMultipiler}}
  name MultiplyOffset
  xpos -494
  ypos 397
 }
 Switch {
  inputs 2
  which {{ShuffleOffset.in}}
  name SwitchOffset
  xpos -494
  ypos 645
 }
set N3ca9a80 [stack 0]
 Dot {
  name Dot7
  xpos -460
  ypos 991
 }
set Nf3a6c00 [stack 0]
 Dot {
  name Dot15
  xpos -460
  ypos 1586
 }
push $Nf35f000
 Shuffle {
  in none
  name ShuffleSkew
  knobChanged "\nchanged_knob = nuke.thisKnob()\n\nskew_list = \['TypeSkew','min','max']\n\nif changed_knob.name() == 'in':\n  group = nuke.thisGroup()\n  for knob in skew_list:\n    group\[knob].setEnabled(changed_knob.value() == 'none')\n\n"
  xpos -400
  ypos 538
  addUserKnob {20 User}
  addUserKnob {52 callback T "nuke.thisNode().knob('knobChanged').setValue(\"\"\"\nchanged_knob = nuke.thisKnob()\n\nskew_list = \['TypeSkew','min','max']\n\nif changed_knob.name() == 'in':\n  group = nuke.thisGroup()\n  for knob in skew_list:\n    group\[knob].setEnabled(changed_knob.value() == 'none')\n\n\"\"\")" +STARTLINE}
 }
push $Nf379400
 Expression {
  temp_name0 xCenter
  temp_expr0 parent.Parameter.lensCenter.x
  temp_name1 xRamp
  temp_expr1 (xCenter-x)/width*2
  expr0 pi
  expr1 1-abs(xRamp)
  name anamorphic
  xpos -252
  ypos 277
 }
push $Nf379000
 Expression {
  temp_name0 xCenter
  temp_expr0 parent.Parameter.lensCenter.x
  temp_name1 yCenter
  temp_expr1 parent.Parameter.lensCenter.y
  temp_name2 xRamp
  temp_expr2 (xCenter-x)/width*2
  temp_name3 yRamp
  temp_expr3 (yCenter-y)/height*2
  expr0 atan2(yCenter-y,xCenter-x)
  expr1 1-(sqrt((xRamp**2)+(yRamp**2))*sqrt((xCenter/width)**2+(yCenter/height)**2))
  name radial
  xpos -347
  ypos 278
 }
 Switch {
  inputs 2
  which {{parent.TypeSkew}}
  name TypeSkew
  xpos -301
  ypos 346
 }
 Expression {
  temp_name0 min
  temp_expr0 parent.min
  temp_name1 max
  temp_expr1 parent.max
  expr1 ((1-min)*max*g)+min
  name rampValue
  xpos -301
  ypos 405
 }
 Switch {
  inputs 2
  which {{ShuffleSkew.in}}
  name SwitchSkew
  xpos -301
  ypos 645
 }
set N3ca9180 [stack 0]
 Dot {
  name Dot6
  xpos -267
  ypos 910
 }
set N1c374800 [stack 0]
 Dot {
  name Dot16
  xpos -267
  ypos 1550
 }
push $Nf35f400
 Shuffle {
  in none
  name ShuffleRot
  knobChanged "\nchanged_knob = nuke.thisKnob()\n\nrotation_list = \['Rotation','orientOpticalCenter']\n\nif changed_knob.name() == 'in':\n  group = nuke.thisGroup()\n  for knob in rotation_list:\n    group\[knob].setEnabled(changed_knob.value() == 'none')\n\n"
  xpos -181
  ypos 539
  addUserKnob {20 User}
  addUserKnob {52 callback T "nuke.thisNode().knob('knobChanged').setValue(\"\"\"\nchanged_knob = nuke.thisKnob()\n\nrotation_list = \['Rotation','orientOpticalCenter']\n\nif changed_knob.name() == 'in':\n  group = nuke.thisGroup()\n  for knob in rotation_list:\n    group\[knob].setEnabled(changed_knob.value() == 'none')\n\n\"\"\")" +STARTLINE}
 }
push $Nf379800
 Expression {
  temp_name0 xCenter
  temp_expr0 parent.Parameter.lensCenter.x
  temp_name1 yCenter
  temp_expr1 parent.Parameter.lensCenter.y
  expr0 atan2(xCenter-x,yCenter-y)
  name OrientCenter
  xpos -110
  ypos 276
  disable {{1-parent.orientOpticalCenter}}
 }
 Expression {
  temp_name0 rot
  temp_expr0 parent.Rotation*(pi/180)
  expr0 r+rot
  name Rotation
  xpos -110
  ypos 404
 }
 Switch {
  inputs 2
  which {{ShuffleRot.in}}
  name SwitchRot
  xpos -110
  ypos 646
 }
set N3ca8d00 [stack 0]
 Dot {
  name Dot5
  xpos -76
  ypos 832
 }
set N1c3a8c00 [stack 0]
 Dot {
  name Dot18
  xpos -76
  ypos 1511
 }
 Input {
  inputs 0
  name InputLens
  xpos -16
  ypos 541
  number 1
 }
 Constant {
  inputs 0
  channels rgb
  format "1024 1024 0 0 1024 1024 1 square_1K"
  name BlackConstant
  xpos 228
  ypos -305
 }
 Reformat {
  type "to box"
  box_width 140
  box_height 140
  name filterSize
  xpos 228
  ypos -213
 }
set N1c3d1c00 [stack 0]
 Dot {
  name Dot12
  xpos 81
  ypos -209
 }
 Reformat {
  type scale
  box_fixed true
  scale {{parent.relativeFilterSize}}
  name filterPSize
  xpos 47
  ypos -167
 }
set N1c3d1000 [stack 0]
 Expression {
  expr0 1-sqrt((cx**2)+(cy**2))*0.7
  expr1 1-sqrt((cx**2)+(cy**2))*0.7
  expr2 1-sqrt((cx**2)+(cy**2))*0.7
  name st2polar5
  xpos 151
  ypos -95
 }
push $N1c3d1000
 Noise {
  size {{parent.noiseSize}}
  zoffset 1.92
  center {1024 778}
  name Noise
  xpos 47
  ypos -34
 }
 STMap {
  inputs 2
  uv {-rgba.red rgba.green}
  name RadialNoise
  xpos 151
  ypos -40
 }
 RolloffContrast {
  contrast {{parent.noiseContrast}}
  center 1
  slope_mag_low1 0.8000000119
  black_low 1
  slope_mag_high2 0.8000000119
  white_high 1
  name RolloffContrast
  xpos 151
  ypos 17
 }
push $N1c3d1000
 Shuffle {
  red black
  green black
  blue black
  alpha black
  name FilterToBlack
  xpos -55
  ypos -95
 }
 Radial {
  area {0 0 {height x25 137.5} {width x25 135.5}}
  softness {{parent.softness}}
  name Radial
  xpos -55
  ypos -35
 }
 Transform {
  scale {{parent.maskRadius}}
  center {{width/2} {height/2}}
  name TransformLens
  xpos -55
  ypos 13
 }
 Merge2 {
  inputs 2
  operation multiply
  name MergeLens
  xpos 56
  ypos 79
 }
 Crop {
  box {0 0 {width} {height}}
  reformat true
  crop false
  name Crop1
  xpos 56
  ypos 403
 }
 Switch {
  inputs 2
  which {{"\[python -execlocal ret\\ =\\ min\\ (\\ len(nuke.toNode(\\\"InputLens\\\").channels())\\ ,\\ 1\\ )]"}}
  name SwitchLens
  xpos 56
  ypos 645
 }
 BlackOutside {
  name BlackOutside2
  xpos 56
  ypos 716
 }
set N1c400000 [stack 0]
 Dot {
  name Dot4
  xpos 90
  ypos 1230
 }
set N1c445c00 [stack 0]
 Dot {
  name Dot20
  xpos 90
  ypos 1470
 }
 Input {
  inputs 0
  name InputFilter
  xpos 157
  ypos 541
  number 2
 }
push $N1c3d1c00
 Group {
  name Flare1
  label "Hack for hide Flare1 pos"
  xpos 228
  ypos -151
  addUserKnob {20 User}
  addUserKnob {26 "" l "@b;Position"}
  addUserKnob {41 position l INVISIBLE +INVISIBLE T Flare1.position}
  addUserKnob {41 offset T Flare1.offset}
  addUserKnob {26 "" l "@b;Size"}
  addUserKnob {41 radius T Flare1.radius}
  addUserKnob {41 size_mult l "size mult" T Flare1.size_mult}
  addUserKnob {41 anamorph T Flare1.anamorph}
  addUserKnob {26 "" l "@b;Colors"}
  addUserKnob {41 ring_color l "ring color" T Flare1.ring_color}
  addUserKnob {41 ring_color_panelDropped l "panel dropped state" T Flare1.ring_color_panelDropped}
  addUserKnob {41 inner_color l "inner color" T Flare1.inner_color}
  addUserKnob {41 inner_color_panelDropped l "panel dropped state" T Flare1.inner_color_panelDropped}
  addUserKnob {41 outer_falloff l "outer falloff" T Flare1.outer_falloff}
  addUserKnob {41 outer_falloff_panelDropped l "panel dropped state" T Flare1.outer_falloff_panelDropped}
  addUserKnob {41 inner_falloff l "inner falloff" T Flare1.inner_falloff}
  addUserKnob {41 inner_falloff_panelDropped l "panel dropped state" T Flare1.inner_falloff_panelDropped}
  addUserKnob {26 "" l "@b;Color Shifts"}
  addUserKnob {41 chroma_spread l "chroma spread" T Flare1.chroma_spread}
  addUserKnob {41 chroma_shift l "chroma shift" T Flare1.chroma_shift}
  addUserKnob {41 chroma_shift_angle l angle T Flare1.chroma_shift_angle}
  addUserKnob {41 chroma_shift_angle_add l rel T Flare1.chroma_shift_angle_add}
  addUserKnob {26 "" l "@b;Visibility"}
  addUserKnob {41 brightness T Flare1.brightness}
  addUserKnob {41 brightness_panelDropped l "panel dropped state" T Flare1.brightness_panelDropped}
  addUserKnob {41 vis_in l in T Flare1.vis_in}
  addUserKnob {41 vis_out l out T Flare1.vis_out}
  addUserKnob {41 vis_mask l mask T Flare1.vis_mask}
  addUserKnob {41 vis_mask_size l "mask blur" T Flare1.vis_mask_size}
  addUserKnob {26 "" l "@b;Shape"}
  addUserKnob {41 corners T Flare1.corners}
  addUserKnob {41 flattening l "edge flattening" T Flare1.flattening}
  addUserKnob {41 sharpness l "corner sharpness" T Flare1.sharpness}
  addUserKnob {41 corners_angle l angle T Flare1.corners_angle}
  addUserKnob {41 corner_angle_add l rel T Flare1.corner_angle_add}
 }
  Input {
   inputs 0
   name Input1
   xpos 258
  }
  Flare {
   position {{width/2} {height/2}}
   offset -0.54
   radius {0 60 89}
   size_mult 0.7
   inner_color 0.8
   outer_falloff 0.3
   inner_falloff 5
   vis_mask_size 2.1
   corners 9
   sharpness 0.98
   corners_angle -90
   name Flare1
   xpos 258
   ypos 65
  }
  Output {
   name Output1
   xpos 258
   ypos 140
  }
 end_group
 Switch {
  inputs 2
  which {{"\[python -execlocal ret\\ =\\ min\\ (\\ len(nuke.toNode(\\\"InputFilter\\\").channels())\\ ,\\ 1\\ )]"}}
  name SwitchFilter
  xpos 228
  ypos 644
 }
 BlackOutside {
  name BlackOutside1
  xpos 228
  ypos 716
 }
 Grade {
  black 0.0001
  name GradeFix
  xpos 228
  ypos 746
 }
set N1c477c00 [stack 0]
 Assert {
  expression {{"height*width < 19601"}}
  message "Filter size is limited in this beta version"
  name filter
  xpos 228
  ypos 777
 }
 Dot {
  name Dot2
  xpos 262
  ypos 1153
 }
set N1c477400 [stack 0]
 Dot {
  name Dot17
  xpos 262
  ypos 1432
 }
push $Nf35f800
 Shuffle {
  in none
  name ShuffleSize
  knobChanged "\nchanged_knob = nuke.thisKnob()\n\nsize_list = \['SizeMult']\n\nif changed_knob.name() == 'in':\n  group = nuke.thisGroup()\n  for knob in size_list:\n    group\[knob].setEnabled(changed_knob.value() == 'none')\n\n"
  xpos 321
  ypos 540
  addUserKnob {20 User}
  addUserKnob {52 callback T "nuke.thisNode().knob('knobChanged').setValue(\"\"\"\nchanged_knob = nuke.thisKnob()\n\nsize_list = \['SizeMult']\n\nif changed_knob.name() == 'in':\n  group = nuke.thisGroup()\n  for knob in size_list:\n    group\[knob].setEnabled(changed_knob.value() == 'none')\n\n\"\"\")" +STARTLINE}
 }
push $Nf35e000
 Shuffle {
  red white
  green white
  blue white
  alpha white
  name toWhite
  xpos 377
  ypos 345
 }
 Multiply {
  value {{parent.SizeMult}}
  name MultiplySize
  xpos 377
  ypos 401
 }
 Switch {
  inputs 2
  which {{ShuffleSize.in}}
  name SwitchSize
  xpos 377
  ypos 645
 }
set N1c43a900 [stack 0]
 Dot {
  name Dot3
  xpos 411
  ypos 1398
 }
push $N3ca9a80
push $N1c400000
push $N3ca7b00
push $N3ca9180
push $N3ca8d00
push $Nf35e000
push $N1c477c00
 Group {
  inputs 7
  name VizBokeh
  xpos 718
  ypos 1226
  hide_input true
  addUserKnob {20 User}
  addUserKnob {6 killZ +STARTLINE}
  killZ {{parent.killZ}}
  addUserKnob {12 pos}
  pos {{parent.bokehVizPos.x} {parent.bokehVizPos.y}}
  addUserKnob {41 "ConvolutionKernel_Overall multiplier" l "Overall multiplier" T "AL_BokehViz.ConvolutionKernel_Overall multiplier"}
  addUserKnob {41 "ConvolutionKernel_chroma mult X" l "chroma mult X" T "AL_BokehViz.ConvolutionKernel_chroma mult X"}
  addUserKnob {41 "ConvolutionKernel_chroma mult Y" l "chroma mult Y" T "AL_BokehViz.ConvolutionKernel_chroma mult Y"}
 }
  Input {
   inputs 0
   name filterP
   xpos -666
   ypos 12
   number 5
  }
  Input {
   inputs 0
   name chroma
   xpos -551
   ypos 12
   number 4
  }
  Input {
   inputs 0
   name offset
   xpos -435
   ypos 11
   number 6
  }
  ShuffleCopy {
   inputs 2
   red red
   green green
   blue red2
   alpha green2
   name ShuffleCopy1
   xpos -435
   ypos 44
  }
  Invert {
   name FixDistort
   xpos -435
   ypos 76
  }
  Input {
   inputs 0
   name skew
   xpos -336
   ypos 9
   number 3
  }
  Input {
   inputs 0
   name rot
   xpos -237
   ypos 9
   number 2
  }
  Expression {
   temp_name0 rot
   temp_expr0 pi
   expr0 r+rot
   name FixRot
   xpos -272
   ypos 46
  }
  Input {
   inputs 0
   name depth
   xpos -776
   ypos 14
   number 1
  }
set N1c4d7800 [stack 0]
  Shuffle {
   in depth
   name Depth
   xpos -776
   ypos 69
  }
  Expression {
   expr0 1
   name FixSize
   xpos -776
   ypos 169
   disable {{"1 - parent.parent.killSize"}}
  }
  Input {
   inputs 0
   name src
   xpos -118
   ypos 9
  }
  BlinkScript {
   inputs 6
   ProgramGroup 1
   KernelDescription "2 \"ConvolutionKernel\" iterate pixelWise 4d3b064f3f42f538158c4677235d8db6e8fcd006e8da52b7a8e3eeb7529017b0 7 \"src\" Read Random \"depth\" Read Random \"rot\" Read Random \"skew\" Read Random \"distort\" Read Random \"filterP\" Read Random \"dst\" Write Point 4 \"Overall multiplier\" Float 1 AACAPw== \"chroma mult X\" Float 3 AAAAAAAAAAAAAAAAAAAAAA== \"chroma mult Y\" Float 3 AAAAAAAAAAAAAAAAAAAAAA== \"position\" Int 2 AAAAAAAAAAA= 4 \"mult\" 1 1 \"colorX\" 3 1 \"colorY\" 3 1 \"loc\" 2 1 4 \"_filterOffset\" Int 2 1 AAAAAAAAAAA= \"_size\" Int 1 1 AAAAAA== \"_sizeP\" Int 1 1 AAAAAA== \"minLayerP\" Float 1 1 AAAAAA=="
   EncodedSource "1 4270 +vduhx3Y8JBmLeiWCjYc02Q9Odx8FJ5dqBe/uX9TgyhEk6K88rIuF+cFmQD78ej6LXg8cuU82LdC7ZdSjjaCt7bMKxSafnhAwKeJiaKUcp/+LiX8yNxidGrQQxLQOP7mJxzynvhLiZBi6jQNXkFsWw9tupyAWMf2qSD10fk3qTUWlMD6XFM/zII9/AmE5qDC2FkhswV5WQTY84O+twxw3U7UMVt3oTZoOTgDFqtGWTVvsk146amMUbTFV1L5euCqLBLp3wqtLoJISJzHd2ZAoqe7Wp2fvMcStAcjK+rH2teU1DYAWu3wiYPfNt4G6DEKr6EhLxyzXbKygpUQGi/bRIBfVwNdNSQAGLJaeVS87Br8uRTYa99IlfQdofoAbA7yN3eMU5TNKrPsxAN5vMOY73Glhws8wLBuKGi4GSkWr99zAt3fI+bwU9PRwXDYykABV9QgbeuntemjHHXdS/tnhSfuNZY+GeeBHPuREeGbfLZ9YUUXWtLe8rSn17XVulmq8uOJ59IU+nTkeOXcGxc6aPNjL0mYltrX1dlFUvjLjXINrYBW+flYNUlAl5DTeaeGX2+bErdRkaCDPocX30k7BceNq3zKlk+wZiaFoec4dTjNVWjogVF+pilGV/6ognty0BUzoNzarJSQhE0JpLbCaFQnQfN0Y9iECGj8ta8eY9jnd9NvbNMjCiSu31KzPkW1tc8VnTZMVJLk5OFsLO93lbms+Cuzl0mqB3W8JzhDnABT0DTrDPUJ27SP3Al9saA403SEkTRgq6IsDiAye08EaQzCx4LM6rFcUcmre/MxbnqTIrh/M9cExcmJYqLeD+avR1j4giXCjEKgOFDt9RgX+h1+ECPz1FLGS08/IHZ2pdEmOXMk9CR9qWpVBfh7eGzVsKAdZVd3nSWWODsnQ7+dlebNiDQht5NXNmxJUwCTS4zH57fbhFY3z99nbJkO4ZimGIzN04BNuhOm6vLuTNzUZrIlMuksgP7DXbddT0O3hXGgCFeeWzOlIWdpI7Sp6HRWNdDwyF1pwPkSX1kfifkd18BzBLh4EByK90AKZwPCufOT9CCvgz2SEZcBz7uZ8K4slkHByMgCxshtu5gSLjczAkRo1RpTRdaoIdh5tBJqHVknbZcjUg9hBT0jn5oiRhiV7coGJsJ5w+d03H+jA2lJrrdRgXIeI9GU7wykkHG/aDBelmxJxUiAg32QYP516a2FBgwTocZFjueSv7uPqMibUsKRroRSFiBd3q6pjlY8yOFzMirIHWUxk56CCb2K6Bcx1h3z9uVJDyq90gdp5PxbHZivP8duNNXAS2Q4iZ4ppa/neLwPoodaCJmbD8hBW1dMOnmo2U2Ko10CqWphuF/2g7V0hD0JyPB8pR5hf44U1gwRbo5DFRB/Up1FDVAr8vreN2iSeXBywuCXzxuXgZIQ1rrPNsAgKK4cwTIS4yjpNHKYxk9DY3/84F3yQ5pI3bnm9X+50t4DrMfnpSBw5oD2+ULOkfmYEyqjdc5bNsEMqeDFIDHxGleiR5ArsvS4PzvdD0IEM0nMgMMJFtn+GMdXsQP2WUhpstPUVAqmLZQ1KZ6JBnbzI++ksZX/NLr4nwAwWWFokRPXmjuX1AnYGMO3/myUTbUOhwlPf1lPLYP2mcwESLyu8kKNY7ppc8oJTCabHUACc0WX3sUYcBArFuzLTfApQfwUNVhUPWxDrxBV2Rt+W1ruSphj+Iz+XSZf0yOO7gz2ahXgS0Eoez02/ytWs434xm9VM//rMhq4hgiloMcsULJQGF9ev9JNsyhl5HhtDxu5zy1ymUnFEoa5GoW262DKtw56mUkRhLGK3AV0qv5CtbteD1C4qBDRScyrBBgG8/OHM8ksWz7idj8rMjilvQ7clTDU4Q8cS4/M5qkHu6iD8fLE0a3qZK2UUzZeOVJQAipVUjbHnOMAIDV1kiRXg3cRWVyXx+3hjhhcpYB0SW0KiFW2VyS8s8aysQQfW4vyKoU8yPDvo3MzN60cjOHaE5hS9T4LDNnUSS72a+MYGhyx27E1PjSk3GifX5YDvQf/IJsdtB4fsUiQDxK3dbZAlu4kDhNEsYDIdlgQ5khdS0/4cPeEp238XUhhvQ2qInCkbsD0BBuiw9FFKp3xf2pFgQ4qhR9rDooNCREwxxGgAuLvXSQxxhqrQzqmcnCfBsdZGMlqoEMdpg+i23MSRyE6OZcQpWTGoLhJ8A/EMd4L61zLUU+zvvDP1e3c09zNA4gKFp9qn4IpqP/t70sddvFudMxSTSFGErLVJy4wxmkgo7nwN6C8s5WIn9BwuRY8wqpRa9nxnO+Qo0HBnbsjCXVsmPuvR5Ri4/WEQgaCnd1uyQTycz90V8EpxVmM/GkwL6t+nJvhYtI57zD+H6ptMbHNkbCA9xRQ1ZbHTetZE+Xqkgao0fNqNAkBXPEUQ9H2JO6Y2sGDxO63amJ068yU/oCDNCBRG9127Lt5RUb87vutcmhWZU3TUq1aB0ZT1QNWaQnVh2jLnUx8g7H8p4E8dOJXCSUyf/9KGd9xNeBNH2riX8hpmt+y11HpxzGGDyFIsqs/iPvvaBkgRzLAjhRuHoPlWLW4XW5deF0nvRJQjaBOrvgmFPqCe84CascRCaSsst+fBWVLCqexODNiWdLOO18i/CyM9CEoDdRDqQoJoW+AQOm4/99CRYH3MvtVJPAtA2ueLZmPmLBBWcfsl7AvPXUrP9bBBf+mJ28SqGFm2nR+kBHUpxAryv3TKV/24JAnK6LvFxEm03waklAeDNM2hdfC0LRZ5VLLhM4j+V785R6vhMhhoVdaImggzqSvkO2F6APVVhiFyIaqFkzhlDm8tyPwAU0Fnaznl2Birg8oF2TJTBtpeiYMo1kWfzxLfbiFXzhFEdtxyZSgftmKH0ZeFPeq2zJHQ4hLoaED5q5Lg9xWCPr3/o1S+FVhmCmTGJB2p4mUyM0w2jSzBim+Y+NDPQFJFJdgD9F5Y/72ASNHD6+5k6X+/Z95U7FiD0CcSPo3bDg9WEYdGIcUOyJz4Bh3pO6QUS1AR0+0J7VQAW50xbrCDre8hvDBrJ8q6XrML4o3M1gs2ZwB5VNFuw/JVC/SDGXk3MuoAJCc9fAqcPlT4ke/fKcJV6HF3uwFquQYl8DQzhsKsjEewBCI6neFcPQxsoCmNVoR3WDGfq+aI28SReClNV+vJXAJmulCqlKJWug/ZJ/UeQ04laQfsUcN1ToerMHOW4ihnIGNBE1CACqgfobtg7nPCbTBDfpr39p9b8krs8aihjZsOYUlB6Sea8Xa/XTJzzd4ZTaeLyYZMCYNMiuX5LedE2vrQ016PETge6oy5e8OwNwmU1ArqAlILECN3YRegmqHwnTigqGTO6vQiWcL4p08xsNVSLQzyrDgn9e+W7cfw315Sp5RieBeAeC7IHePXTZG5MjvPGrYci3gOMdXtubz0QSP6MIJnRPZIAvKdp1JlmEVmUBp6/nO0+BaJRMtvkU3Xdzvsd86rgz+DyylHJQSZN2+n82R8lq/vgiWBmxNYCs0+NTtsgImIimbfylxtdksI1BpdBKLnQgZWbOFZZauEHu5Y5L7sWxuTeWKqmeRFPVLm+NCTo/oFSUz5nfuJS4m6PfFBueuCQO9muiESJz9QQpDdNjE4Tl0SJDUFY0pLDgdFS3Pz3cDRCvGNgEaehxPirqw6jmnB6QhetzvbTH7ian8WdbhoxxegTV1pS/ywchN+BmXuC6KWJMDbmQ6CJmKE3gQVwoioskAwZ+GlTrTtxG15uTKSOLkRSPV2reM//WHykEMgB+4BA/PoAwtiLFtJ7BI8301zgWDEgLmrXGRIPMnWwyNd+KauyqlnNT4fpiaiCAJNtY77eILITUv+xf2N46e4G9hQl+HSA1/KJw7pnTwQXDqHHFwBhqy2sH6sL5dNORnbvBSFFVJAiJf3UbI5txjrNQNbP7ed1q0gF0wDDBBSC4xLS4h8znQUrIotZ/I8A77dMmpjWSZ9eeqYmB21KnGRSQyydgFrA5V4BJRRnu5AjEKa+GefStXb6xNsBbnZCJHbzor5TizRpwNq56BpyWPqXJXo/W7C0JHdVPsTCSoxKYAP71Nd9CzPqXQhIXmQ5Cof+FhZsUNtavMKxoJrLd3UsbMpgLyJiuLqNmx6ulqg1fx5unGkTlu2TCzppe0Q9Nh7Z2YJFG1gxuEtrGLmJjy1oqVMbtZhuekJ5mwN7nTC7H/e0E4aQj7ocn09kokcplur1sIArRIbMPZYuMWeMY0+Y8XY/WLNhPiXf+052F1F4+G0foM+HoUCHSdTi5BqFU6ANg19YqKY+Ds+C+ePDwTq0XbfCW7PdLoxwX+mSp8tH4GKBJEIR4t85WgjCPDu613JlCYkQsnQKVftbYtDV3tKd84e3/17qja1eya1JeIBumvI66vTYOxkBxHzFPzHvlvQ/pWKL13+Cz5YJYiTexAgTsWgLmqc5JJmFyFm0+c98mnVYb7R8Ib54KzDNAOSPh5dVVT7utDXCmh9mXmpPZutyH0r90J+yZnZ0XqdR3APeE7wnKNdaJafgT6/t6AeC0Fbhw83axUz0NnaLduZtA8sVduPa8l1vMR52amCjkLDUwT58q8Et5v2/OEC0RnHCfFWqh18RViP+kllv75EYsxZ+12A03PbNwTYK/BaTE7Mz4/7eJfY5/WToYcvQKxQhmx1huEgyZxuZj3whcFq5T0qkOtOtv/fJ5GEphfYpE70vJaUWvDCUsgYJo3yWidbT+/xZZj7bQh6i4ZTzJo/kU23dKytUEuhRHYCgHTMLrfL00rosghTLwHNt4UVZBM4rwhV3GaCaSxgNpjl6tfGM8i+U8pkkFzYyq2RtpiNGi/m82PO2DHnyFEYtsQMiwpfpd/WjcKTGcvLOQrlgJ1iq74FqWPGHlvE9xBmJbWRZDsbmVp2rf+KPTr8mCos5sZK2tlMclL6O89ym0WsiPC5ApkhNCoYmVCnHTaZufbKKgySkLEMGcMuyq7Gw47rHG2YVyc8kdvr1MkgwWkssXDcUyW8gfxXHDZve6VZZ/zw6fvcH5CYDpgtaGmMnYyVZzR/4ZUMWsks6U+MVC6+/csVXyTDYcfhnoaoWFOX6AA3oTo3vwfnQIZI2ixeIWwYkfpcO257VihVP8r6y6XtfgHbSch+qel/YjGJLPL3oxNujVNDPVL11nemLLcyNyhM5+S4bfDa/3UdGqiHnVpN8pLuuxntBXqnbyAFrmJ1GhIz+e+4f5r8GmPd772tFntyd7AqYeWN0q/48lgiF5J/+ZxS4RG1DeqhTo6HUlU91Bte07MxXycO9jMCThVtiFk2dgYWYEplUL6GNhRpY+L7M0Xa0lf/56Xf+jK1q7an5G/vB79wqQ0vZZ+AoVbB2sqO49RY6BnqhPv+jII6dY39coOqIvQmQPaixlg0O6uL4Z4Y2uc6hHywyOnP8b8eQ2FeoencDrrCdFlF1I2rFNOi/SIPTunA2HF+VbLzxF/qESEr7rUWO9ZPC+KZAsEsGaNHussejdx8rvqmSeRpKX9PI2Y7POuQzgDEI4upebuRgPkwUENRCDXwMf1N+UrpZgbPyrNYQsgyZVtSFE948U4QIowUs+vgOrbRpxgNw1GfcJsT/smP+TWTSm1O9j7GzbyZxiq7kKpHGFQfEp9GeUsifrkGrgedSmDxDu4JLxyGiWz/W5UPLyez8Cm5vWQECwK"
   useGPUIfAvailable {{parent.parent.Defocus.AL_Defocus.useGPUIfAvailable}}
   rebuild ""
   "ConvolutionKernel_chroma mult X" {{parent.parent.chromaR.x} {parent.parent.chromaG.x} {parent.parent.chromaB.x}}
   "ConvolutionKernel_chroma mult Y" {{parent.parent.chromaR.y} {parent.parent.chromaG.y} {parent.parent.chromaB.y}}
   ConvolutionKernel_position {{parent.pos.x} {parent.pos.y}}
   protectKernelWhenPublishing true
   rebuild_finalise ""
   name AL_BokehViz
   selected true
   xpos -435
   ypos 163
  }
  Expression {
   expr3 1
   name FixAlpha
   xpos -435
   ypos 209
  }
  Transform {
   translate {{toBlack.width/2-width/2 x253 852} {toBlack.height/2-height/2}}
   scale {{parent.parent.bokehVizSize}}
   center {{width/2} {height/2}}
   name TransformCenter
   xpos -435
   ypos 245
  }
push $N1c4d7800
  Shuffle {
   red black
   green black
   blue black
   alpha black
   name toBlack
   xpos -692
   ypos 244
  }
  Dot {
   name Dot1
   xpos -658
   ypos 295
  }
  Merge2 {
   inputs 2
   bbox A
   name MergeBokeh
   xpos -435
   ypos 291
  }
  Crop {
   box {0 0 {width} {height}}
   reformat true
   crop false
   name CropBokeh
   xpos -435
   ypos 343
  }
  Output {
   name OutputBokeh
   xpos -435
   ypos 392
  }
 end_group
 Dot {
  name Dot11
  xpos 752
  ypos 1365
 }
push $N1c445c00
push $N1c477400
push $Nf3a7c00
push $Nf3a6c00
push $N1c374800
push $N1c3a8c00
push $N1c43a900
push $Nf35e000
 Copy {
  inputs 2
  from0 rgba.red
  to0 depth.Z
  name CopySize
  xpos 494
  ypos 727
 }
add_layer {rot rot.O}
 Copy {
  inputs 2
  from0 rgba.red
  to0 rot.O
  name CopyRot
  xpos 494
  ypos 822
 }
add_layer {skew skew.O skew.I}
 Copy {
  inputs 2
  from0 rgba.red
  to0 skew.O
  from1 rgba.green
  to1 skew.I
  name CopySkew
  xpos 494
  ypos 893
 }
 Copy {
  inputs 2
  from0 rgba.red
  to0 backward.u
  from1 rgba.green
  to1 backward.v
  name CopyOffset
  xpos 494
  ypos 974
 }
 Copy {
  inputs 2
  from0 rgba.red
  to0 forward.u
  from1 rgba.green
  to1 forward.v
  name CopyChroma
  xpos 494
  ypos 1048
 }
 Group {
  inputs 3
  name Defocus
  xpos 494
  ypos 1226
  addUserKnob {20 User}
  addUserKnob {41 "ConvolutionKernel_Overall multiplier" l "Overall multiplier" T "AL_Defocus.ConvolutionKernel_Overall multiplier"}
  addUserKnob {41 "ConvolutionKernel_chroma mult X" l "chroma mult X" T "AL_Defocus.ConvolutionKernel_chroma mult X"}
  addUserKnob {41 "ConvolutionKernel_chroma mult Y" l "chroma mult Y" T "AL_Defocus.ConvolutionKernel_chroma mult Y"}
 }
  Input {
   inputs 0
   name filterP
   xpos -128
   ypos -21
   number 2
  }
  Dot {
   name Dot5
   xpos -94
   ypos 107
  }
  Input {
   inputs 0
   name map
   xpos -232
   ypos -20
  }
set N1c53c000 [stack 0]
  Shuffle {
   in forward
   in2 backward
   blue red2
   alpha green2
   name ShuffleDist
   xpos -637
   ypos 92
  }
  Dot {
   name Dot1
   xpos -603
   ypos 362
  }
push $N1c53c000
  Shuffle {
   in skew
   name ShuffleSkew
   xpos -472
   ypos 88
  }
  Dot {
   name Dot2
   xpos -438
   ypos 228
  }
push $N1c53c000
  Shuffle {
   in rot
   name ShuffleRot
   xpos -355
   ypos 91
  }
push $N1c53c000
  Shuffle {
   in depth
   name ShuffleSize
   xpos 177
   ypos 102
  }
  Dot {
   name Dot3
   xpos 211
   ypos 383
  }
  Input {
   inputs 0
   name filter
   xpos -2
   ypos -22
   number 1
  }
  Dot {
   name Dot4
   xpos 32
   ypos 148
  }
push $N1c53c000
  BlinkScript {
   inputs 7
   recompileCount 1
   ProgramGroup 1
   KernelDescription "2 \"ConvolutionKernel\" iterate pixelWise 18f5f02302b9f8b9ef0ef1e0603bbc4b09e6b6a3ed1f76911451b1ddcb89969d 8 \"src\" Read Ranged2D \"filter\" Read Random \"depth\" Read Point \"rot\" Read Point \"skew\" Read Point \"distort\" Read Point \"filterP\" Read Random \"dst\" Write Point 3 \"Overall multiplier\" Float 1 AACAPw== \"chroma mult X\" Float 3 AAAAAAAAAAAAAAAAAAAAAA== \"chroma mult Y\" Float 3 AAAAAAAAAAAAAAAAAAAAAA== 3 \"mult\" 1 1 \"colorX\" 3 1 \"colorY\" 3 1 7 \"srcrangeMin\" Int 2 1 AAAAAAAAAAA= \"srcrangeMax\" Int 2 1 AAAAAAAAAAA= \"multP\" Float 1 1 AAAAAA== \"_filterOffset\" Int 2 1 AAAAAAAAAAA= \"_size\" Int 1 1 AAAAAA== \"_sizeP\" Int 1 1 AAAAAA== \"maxDist\" Int 2 1 AAAAAAAAAAA="
   EncodedSource "1 5478 +vduhx3Y8JBmLeiWCjYc02Q9Odx8FJ5dqBe/uX9TgyhEk6K88rIuF+cFmQD78ej6LXg8cuU82LdC7ZdSjjaCt7bMKxSafnhAwKeJiaKUcp/+LiX8yNxidGrQQxLQOP7mJxzynvhLiZBi6jQNXkFsWw9tupyAWMf2qSD10fk3qTUWlMD6XFM/zII9/AmE5qDC2FkhswV5WQTY84O+twxw3U7UMVt3oTZoOTgDFqtGWTVvsk146amMUbTFV1L5euCqLBLp3wqtLoJISJzHd2ZAoqe7Wp2fvMcStAcjK+rH2teU1DYAWu3wiYPfNt4G6DEKr6EhLxyzXbKygpUQGi/bRIBfVwNdNSQAGLJaeVS87Br8uRTYa99IlfQdofoAbA7yN3eMU5TNKrPsxAN5vMOY73Glhws8wLBuKGi4GSkWr99zAt3fI+bwU9PRwXDYykABV9QgbeuntemjHHXdS/tnhSfuNZY+GeeBHPuREeGbfLZPgi0jwAfua3y9wz7aMmmdPpQ0mgcr8bU0dTO5dq23rRRz604yuBUEIqtNAr9tPgMrMvIIXJ9Qv6TV6/762CUamq9EjD7Ktk+BKdp2ObN4buV/TyMdi8x0X/fmJEGQTUClO9Gkg26CAwbkzyhMchxPXY6pWlqfSh+GvJbyUlaSTqiJDDAplaqC7ceuTOsTy2igv6W3czeBstNZ/s2xbgDvNQhgXgNK181MxQLpQ/NT0jSkOpFTDcA1h0TkE/x9mDGeAw0fvPPGAN+MHt36SYotXsb6opeb3vorahAxGJdKHAWp49nOS3xzSYug5qVaRbata+VpGKMj6sZhlvV6JTaAj1PZJrq3MzQMXAZIBvVGsMISTQQtkXlqlmzKcadkL4znr23PC9+DOltGiQ9mcoh2R1v6UUY+MGao/RqGKuL36yUNlQJiRThIs4LuMRbfCZKjfrpp/qCEJKxwYfAuh8uDeopobYme+TSW3sntdDkTHuqqWhm9rRPgo4/Da0EngqKpdrsH+wGmIOWQqzsBaV1M5bC1e0uCbOifJYeUJ5yHMEcsya15P7HSTIWUU1IimOdY8uXzxPxVgnAhB5wgBO9m1AsSEa9OZRppMLT0EcW0EMECGvmE9ScODRPEajtrvG2+Pc0xuvCSCALtOmm3yd5LqLNwviS0yZgzIF+rZgeEkpuo2fhsRSBB7z5bXQOumsJxK/5d3uTpzsulAYQx1yrlejO+0ROgWcnkS/g4b8x3ZcYJ366JnxtNaGuwdkxI2bfhL/Ox9z8s6xyeTu1rzxqEFmkco9YJ+ArzNsL6N3SfQ+74CdkSxQEMKTi69bErikZX5CMbkkRlUl3IFGPOHndrfcLaEhS9bm5ncJnatu5TXXucrLKqEqPD2bhuABSpbBUCWJ1O+yJcVkg38fDSy3OHECLP5JQ4MR5RY37C4mZZwD+pNW8D6gXansDyPLYPtLBIdWB3+Yfz9M0+CEO8nqK6INunF5pK2b32AHX6VkyKZMjFgR9ZcoVu2ksdpevxynvL3lxR2xt7Lne0Hgo5r9wyNJYAJ7qGFvNA1FdLhVP3uWyemQIrFM4HhZxXf825t+e0G32yzi78kMO4MrlLvyOuOhXsvU9dY1+3BnVXzgaHhx6rhPI1sSIL241uNCj6mT4icTmFhytdumbz7TS8u6ltf/oOZObwi5yL0MP34xSYMBJGwbrtBDPfYPwWNFnjvlfFbxWRhzGwsFbLfo1XG/t4nvC0uGVVqzyNwInxS+kdnXbTHSGyc8NvwN3IujCeanhkh4p9SSz8iH0N+uYZ122yAi8+vEa5G0oRzEcRhz4ZIJlNWqY290kTMjhQg/HAtjOuGfltWMV+AIr8PpT/A/Nqn4ggVqJbaAoBxrTA7F4mGunJMn7/bjt9SShr6VfLtBl+9uFBwasyIqitT1P8LuFY3MjfpCzi7n60aWeNTy1OHNUG/amhynhTq1ud1kerBJV/ZOJsDSWrNf4DD1U42CJvqaESqXu88JVvRJBAp044VfAMWDkhR25lbcpzKhQkmE0wGBZyamOpwddYikY4GIHbwyn7e9U855Ut2qK7p21BT/3dL+ae9A/dEcpzjp96Mc/m9FZyVxPmGB+oy/jMmqxBS1YyaWph/rPDOXi9qACPXEF4XMvqqqjdk/oM+94P/6jPEhJ/KJ4eZ+uVrLqIk1CuPOB8W18NiXtG+5pA3BRo+CcdbJlE5kOoNQ8Bz9mGvCrGvcuv6WhRtxrDBYJFfgJzLPsxl0YA6AFIPgou1OvKXAIHocACZ50/OgXsJWxFCrRzpnpFXWwsTSX5ax93Qq+Rj3urqKPLO2t6vVHgzM9CaK3awerGqrETbaS5+jcjyvDuv/ugWIn9MxzA0zylKw6NcjafK1EER8JoTU+pS/4gdnvqVReJ7xwcjzeDdN+cwM9S0X6XFQAbTvXHux1whlE7QjbsoiRIAv9cAhbyoWbUjP8dWPsikukKT415u9lCqa1M7mCKmxyYh9xNckR7Mn1ZtPnmwCQvHOPyTHU8P/9iI+Kh6dos+tQ18o8dbvz8hIsCU8QTSYMCm7FBS03/DWxiwxhpEfHsfyQ1Hu0jwK/FESOc0+iW39LVgFUGNafby3Al3vf0OXUCFvkpDHHWk/A1X4nnr4Zy6nt2Kt2MWY7LMPpDEiaVU9UxYN6epdiEYPBo4tgpu3gBLAPle+Mv2LKtsKpGj3QHK7YhR+bU09gUT3/+YbCRpB6bXR5jP6p4lBs3Ni0Q4ttqgkk90CfudD8fh/9TwjMYbTN5ST5XE0bbBzl7hpVK9gGvLiZLY4qpyrzdZOEv/u9cDyIYkUmM3HYcl18KqdGTDsOw58GI/tL9AmUbxKmxHxiTspBveOsr3nabUHxE4ltdC+xLSF9U6M3Aw9syLzmTTANAN4/uB0+yxWTKDW+g6PNRIN0RTfQBRE5Bdwh50g2KQ2LAZcp0kQC3MAmwwkGxv5r+rV5ALf+F5h0gbsEFSb2eC/5YOBIuP5MDUsRUuvgXe5XNrojyZpKAwEVaS1skoI+qAn9fMDs70b8yUrlNkXZAeRligPSB2qRZiWCCRCh8sQnKDicJ2TxrVss6xOiRyATUuXLO/HuRMJV3yPk4EaWfA6NCR+otJHoXT07gQl5QJnPW3ojPxac7BmwM/PQgGtot1f+9+u/qubOBB1oTNfeM8uCB1TWLsUMgCBZpSOQubzdlOJaUo+0T2un5hzEwEzH6n7KLrqt1x0n++BEcpNXpfDOmeLSoxyfw/w5TOO0e0DNkC57J9V/jOlNS1Njjcab7jqp36IKF1vZAuU9gCO9wqwrWLDigRN1zzSHBrhcEKBtHAaHlX2zpfPLMRkuuvZrP6DcwAwWAYwWigThvcJCxb/FWwvm6Z7J+4XLyvcKlPtseHKnL7cYAKtMW8VJy9TwXjR9ogr2EI/4WKr+5xPRymnJ60qCms3tQAPQ6mtsnXB5cJYsJf0fOo+OLcv+UVAu8GFwln8TJ6VjDfihKPwKD9bks/2LgvflpFyPY204hThP4jX70ucoOXmMEnvEH0px93brinYOPjfc8jhIaMBFTF1NEnFoZhkiB6P73a63erPXLQdi1JBC9evQbSujwa2sEMFh6i1hnZjbBgz0DGx2qsYkLuy1rwublIEsuBb5MGoUJdZEljHhJeLjwF3uEVu6OZSVMpRG0VStEAtj5wS507lThVBYtUZaagg7awmHaqu6LPzHV/6IDFXKWVXU7hy9H9nmYe416fBm1Ci9YC7IuWBBKq/8Frzqkm7oC6Fm0SR6yXKq/SlVR6+LfUQK5+baHIgaUqZ4XKxdDNR6Rgc6nGuhhGY5sroqnp0kwF7EjJZGmCcO47d7Qu1WyfWBv+AQMqijy5R1pMWDImKB8ZNuuRCkH+jBf9QMowu29/rT/kMH4d+aSN0lf6EtrAVlOsgtE5H8ooEP3eIbwujpo/rSUEEqPGH8BRpMKSZO+/AiGsZsyl+AdVbaPxQ7+AMajDTWDKaNNbG2PiARycZ+jZw8/AnepoWsiT3jnoHGEhSSChPYRhfaEiKcbp+4DP1BQhU9Tib7VQ8ZEQ//WoQ1svpnDue93t+RN6WQd2HygNhFiiEGF6gZLDKSYbYZrbvX6NNBp72NEDtSh9AG9bsOHVFsEjmUrBL2Twp6Lp0mQudoO5/wJGmDEtYyn6JMHJMrRwBicxwGkmxiKeyT8UhgOI0x8V4W1Qj/SLx1IFhjsJRtK8CYu5kZSfuhgPniUx5fiMkxlqeHFrONsc54pdlKNdYfqs/9q70GFpJkgYnOPrcnf64Lk4/Luaolkipgo1L3Sb8zVVGdSj9laraRf2kNypE+5uhGNZUdz2Dxfh6d6zx4hg56weokM7dP1FOF8Fdu4dBKSH1Q2UMxah6A0psDSO6ss8KosxcXwrcPdeZMqkYD+LwI9KXNoChGTjtEbxqc2Rmd4blju7i/NPylIZ82BjywVg7D68Zfw8ute9Yp/DkhiaBOr0IaPmPhugl39JP2n4+OK+TuERVt8UBGqGEFmfkuKNjgp2LK0ZrqcN8LQxUSmNvhzXrP0dJJZ8qtk3c3TVcoo0zHibr729PJDoMXAX4SyzxK2oO3DPw2Y/8AjWvOuVMPJezw7Myr/3xwHCB9Pf8OJyhGyKSi3mT8JImWm27Y+op4D6l2+TAvcy/0QRcjs5V/5+9JrKGQOVj9y+YY9rJ4HKa0yAl13mKmhdvbTD7wgPgDxzIW14OUi/3XX6KegsNj7S95ooY7sCUs/vdZIy1L0jAUnY4PH2Gb8jlJua5pKikn1J7E/gNxTU0dkFPCeGGHyYNNmhf/gm5mY++BPgfxN85frFPPeEDh4rkBqSOzSfGzMG1BuZfRM2yzNTZYNzkCUgUuQjjhIo4X21spoXJVg/i1lVUcMv98+VW2UlrG6kF3ccEZIIUtFUw7vDDtckpCvoQkBy92OPxh5jtTokAQMKTrLQBohrl2QbznhxBdTxocKdDIWrLvKfxmj/PyCJ+4tYbhooixQyZkq9S56+NDJcprmCfTHGzGcPmUzAd+a/dLAh0tQXkxC9LQHNtPJ41yG2Q13/j1c/L4YGWwcw9TsZQ5j+rdI5qBaQQLUhy5XuPLzzIGgb/av3jDyLD/4hU94m/DmtHz8fjiM8/PtYHfO+/zKazSHFqGLUMz4atSlqQYzPwHx6rhcPh7b5MZRTpfgRWvzyEBFRhxFeNm0eR6vbhWku1/4Fwx1gFZZ3ceHVg3RYuc6iLYdWSltAg78PiqhbNg88McRjGxcHflhRfkSSo3Ug2xYcmyUP0xLmS9PK+BuvvF9suQU/HU0AS47/Uf/5bf5XLIJD+Fr1ffaLzO9OSTlcrxpwKkfZUc9euVHllFCzr9w3tpzrFaiTFMUKGPKK+On6+zfm7IFnw5//7JKXkO0e6t/QOG7NoycCeCGfleag2UE+yRfbpAroo62sNNy9vup6UAo8ZHmwGbj7+nuhJG7L6pvtJ5gxO7TasEHduhp+H+8Sb6nXI1M1CxtcVBjGyU0huEDD88ZLFJFgWgVgmlnNw6OuZKjIiXRVjVLo+VKlfFAr3s9U90ZPxvfjMJH1aJsh8KsijgBMkF1idWQSB9a56fZ9TcLrpVwHEXB82D8t8hdDPgmaQXCpFiDoP2C9M49Oxg0NjskARYjpBSgxKWMMD+E5aq1M/RhaN3Jx8SzioydHXxLStzTCQpMffz+d2CtJ9BvsyD7m2gmbMcTI8S+JUY97zCB7zP08ZFC2LezLxsTZllYFiQYuwUaN8OZ0woJL27CyuBHtkIdjQQqfnCC2b1uvP/XyDiZaGEFsEj4Dh7J6w6hmOluaCMShoPx0+2nRZjbXDnQJwCvXLaHGUFJBSDQ+NTiBTi6ikX2Za5RH9hZ4AdBdjBBj8c6MIDhFwD+xX38zmodZ+FmjUE5U5qYxQLN3AWMhO99trBVDyhc8XraC7HomUHEWOJm5MirzIMNzO/QYP8IBlwa4GAK4Mh3UdhSxoXGAMEEfvBLAV+pRLJczC16UtWPvIAHXlWJKauHlh3s7XGMAYaVlXuNM8u7NS0c0JoG2+iL16lzNmv1Kcqe7AJomdYgpdXUkorun+59OqTcNNUIpVuLhjD7WZ5wrE/3EB8xJ894iuSRqncJBMtaeDyfiCVhQD+mMjP1WJ6DLG/ZbRseDLIEW1v2QUpBfg+WP1rLVTFDJPUi1PlHerHcZNOFWbEZHjRfVtkD3+nnKRkU0PJWxd+9XlEL9xEUE/QL6dMfTZAPaURnR8gQPfgkmdu1qcceRa9QWececJc/O0aokW5Lt6/xF4Rao/k/f+EsxdMdylSirDoi8sFdTw05w3kugNF2fjTPAKTDGFKk+chOZw0Ymou5M/+UUb7lrOmnZ8XMjK4dtSW5kYjGZ+V7QrZJA73sXUvOKuYZHYh6dXiVlrWSP2015yjV+XbVUhXcvd01OqhGsxXLvXohNX4RBxQnctYoB6OT0howEeYPKYcQPPUu5B82DSrfANhJK9GxxQMlkWtn02lFGSvmgLG/EFm8Tv0+qyDZATqJp+AONOHw6GIoKstEh9c22fKVD19gtlMnCJ7CA0ZrJ4p8pQaxJjMTyO5kVHPfcrjPLSlA0HJ/nspbOIMBA9vLxBNzd5agF3kezCEuyqMvqZlju0Tb+Xlt597aNLMB19L38ICMxNp/lrvrdAlAuCJX647kQRkIrrf6uKX3n3c36TzaNef1AdtidKhdQvrgYPclCJcQvk2Sa/xBIhm6OxgzmJCteU4GAaBg3jervMxiTM/Y5ZEJRiF4zGi5mvx/mOSQGHrB2T109gparXxXJv752Hz7t2Qfu0vfHiwKoxSHu16+UH8Yb9Ekw2tl3JAyYzgTODhLaDZyjK4B1Ha2If3NDIxNTsRwxjIhafHtpmo1puTpTshX63CjBRJhQV+xESU6smDWFivtM1qso093LY/dgoGWIIL2yX3R1H6UKFisNbh2HsF5FKn0H406nl5kfm9KmeWMtx67lyQB13l/g8xVO1Zl4SKz/9pPMLtTPq0Xn3tN4TgrS4W6w4SCZlTJAUIvTukBIcRJEgp9jRBGutOUWtM2sN6Gd5M5Y7x8hY4/p2W1+rxxEAiTB23jGOWnvLe5zJZq3HA6MuGWPpCE4G0V1Bfq2nhLjspna0aeCnqan5IcEhNtjWxv6Kf8wwTwpt2REuvJSAPGrIbkEDGeFfB/1C1mNOzh7t9yEVqNsHGSVgCvqY7oeFFNYnnrH/H5rS81snB3/jt6GLUJ9KaAp7eZhF3ktlb66dZLZRfG0CXBK+xAqcx1WOBp4U2RQQzO+Idy8EyX78TIaDAVAGcGtX1EyJkvdR5VyA=="
   rebuild ""
   "ConvolutionKernel_chroma mult X" {{parent.parent.chromaR.x} {parent.parent.chromaG.x} {parent.parent.chromaB.x}}
   "ConvolutionKernel_chroma mult Y" {{parent.parent.chromaR.y} {parent.parent.chromaG.y} {parent.parent.chromaB.y}}
   protectKernelWhenPublishing true
   rebuild_finalise ""
   name AL_Defocus
   selected true
   xpos -232
   ypos 199
  }
set N1c5a5800 [stack 0]
  Output {
   name Output
   xpos -232
   ypos 377
  }
push $N1c5a5800
  Viewer {
   frame_range 0-350
   name Viewer1
   xpos -773
   ypos 185
  }
 end_group
 Switch {
  inputs 2
  which {{parent.OutputType==1}}
  name SBokehViz
  xpos 494
  ypos 1361
 }
 Switch {
  inputs 2
  which {{parent.vizSize}}
  name SSize
  xpos 494
  ypos 1394
 }
 Switch {
  inputs 2
  which {{parent.vizDiaphragm}}
  name SFilter
  xpos 494
  ypos 1428
 }
 Switch {
  inputs 2
  which {{parent.vizLens}}
  name SFilterP
  xpos 494
  ypos 1466
 }
 Switch {
  inputs 2
  which {{parent.vizRot}}
  name SRot
  xpos 494
  ypos 1507
 }
 Switch {
  inputs 2
  which {{parent.vizSkew}}
  name SSkew
  xpos 494
  ypos 1546
 }
 Switch {
  inputs 2
  which {{parent.vizLensOffset}}
  name SLensOffset
  xpos 494
  ypos 1582
 }
 Switch {
  inputs 2
  which {{parent.vizChroAbr}}
  name SChroAbr
  xpos 494
  ypos 1621
 }
 Output {
  name OutputDefocus
  xpos 494
  ypos 1800
 }
end_group
